<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>천년나무6단지 작은도서관 도서 검색</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

<h2>📚 도서 검색</h2>
<input type="text" id="search" placeholder="도서명 · 저자 · 출판사 검색">

<table border="1">
  <thead>
    <tr>
      <th>서명</th>
      <th>저자</th>
      <th>출판사</th>
    </tr>
  </thead>
  <tbody id="result"></tbody>
</table>

<script>
let books = [];

fetch("books.xlsx")
  .then(res => res.arrayBuffer())
  .then(data => {
    const workbook = XLSX.read(data, { type: "array" });
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    books = XLSX.utils.sheet_to_json(sheet);
  });

document.getElementById("search").addEventListener("input", function () {
  const q = this.value.toLowerCase();
  const tbody = document.getElementById("result");
  tbody.innerHTML = "";

  books.filter(b =>
    (b.도서명 || "").toLowerCase().includes(q) ||
    (b.저자 || "").toLowerCase().includes(q) ||
    (b.출판사 || "").toLowerCase().includes(q)
  ).forEach(b => {
    tbody.innerHTML += `
      <tr>
        <td>${b.서명}</td>
        <td>${b.저자}</td>
        <td>${b.출판사}</td>
      </tr>
    `;
  });
});
</script>

</body>
</html>

